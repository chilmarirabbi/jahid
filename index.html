<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CTM INCOME üå∏</title>
  <script src='//libtl.com/sdk.js' data-zone='9903237' data-sdk='show_9903237'></script>
  <!-- Firebase App (core Firebase SDK) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <!-- Firebase Auth -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <!-- Firebase Firestore -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
  <style>
    :root {
      --primary: #00c853;
      --primary-dark: #009624;
      --secondary: #ff6d00;
      --secondary-dark: #e65100;
      --blue: #4285f4;
      --blue-dark: #3367d6;
      --dark: #121212;
      --darker: #0a0a0a;
      --light: #f5f5f5;
      --gray: #2a2a2a;
      --card-bg: #1f1f1f;
      --gold: #ffd700;
      --bKash: #e2136e;
      --nagod: #f8a51c;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, var(--darker), #1a1a2e);
      color: var(--light);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow-x: hidden;
    }
    
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 10% 20%, rgba(0, 200, 83, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(255, 109, 0, 0.1) 0%, transparent 20%);
      z-index: -1;
    }
    
    .container {
      width: 100%;
      max-width: 500px;
      background: var(--card-bg);
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      position: relative;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .header {
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      padding: 25px 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .header::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, 
        rgba(255,255,255,0.1) 0%,
        rgba(255,255,255,0) 50%,
        rgba(255,255,255,0.1) 100%);
      z-index: 1;
    }
    
    .header h1 {
      font-size: 28px;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      position: relative;
      z-index: 2;
    }
    
    .developer {
      display: inline-block;
      background: rgba(0, 0, 0, 0.3);
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 12px;
      margin-top: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      z-index: 2;
      backdrop-filter: blur(5px);
    }
    
    .developer:hover {
      background: rgba(0, 0, 0, 0.5);
      transform: translateY(-2px);
    }
    
    .content {
      padding: 25px;
    }
    
    .user-info {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 15px;
      margin-bottom: 20px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
    }
    
    .user-info p {
      margin: 5px 0;
      font-size: 14px;
    }
    
    .user-badge {
      position: absolute;
      top: -10px;
      right: 15px;
      background: var(--gold);
      color: #000;
      padding: 3px 10px;
      border-radius: 10px;
      font-size: 12px;
      font-weight: bold;
    }
    
    .stats {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
      text-align: center;
    }
    
    .stat-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 15px 10px;
      width: 45%;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
    }
    
    .stat-card h3 {
      font-size: 14px;
      margin-bottom: 5px;
      color: #aaa;
    }
    
    .stat-card .value {
      font-size: 24px;
      font-weight: 700;
      color: var(--primary);
    }
    
    .progress-container {
      margin: 25px 0;
      text-align: center;
    }
    
    .progress-label {
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      font-size: 14px;
    }
    
    .progress-bar {
      height: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
      position: relative;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      border-radius: 10px;
      width: 30%;
      transition: width 0.5s ease;
    }
    
    .buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin: 25px 0;
    }
    
    /* 3D Button Styles */
    .btn-3d {
      position: relative;
      padding: 16px 20px;
      border: none;
      border-radius: 15px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      color: white;
      text-align: center;
      transition: all 0.2s ease;
      transform-style: preserve-3d;
      perspective: 500px;
      box-shadow: 
        0 8px 0 var(--primary-dark),
        0 15px 20px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      z-index: 1;
    }
    
    .btn-3d::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      z-index: -1;
      transition: all 0.3s ease;
    }
    
    .btn-3d::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.2), 
        transparent);
      transition: all 0.5s ease;
      z-index: -1;
    }
    
    .btn-3d:hover {
      transform: translateY(4px);
      box-shadow: 
        0 4px 0 var(--primary-dark),
        0 8px 10px rgba(0, 0, 0, 0.3);
    }
    
    .btn-3d:hover::after {
      left: 100%;
    }
    
    .btn-3d:active {
      transform: translateY(8px);
      box-shadow: 
        0 0 0 var(--primary-dark),
        0 2px 5px rgba(0, 0, 0, 0.3);
    }
    
    .btn-secondary {
      box-shadow: 
        0 8px 0 var(--secondary-dark),
        0 15px 20px rgba(0, 0, 0, 0.3);
    }
    
    .btn-secondary::before {
      background: linear-gradient(45deg, var(--secondary), #ff9100);
    }
    
    .btn-blue {
      box-shadow: 
        0 8px 0 var(--blue-dark),
        0 15px 20px rgba(0, 0, 0, 0.3);
    }
    
    .btn-blue::before {
      background: linear-gradient(45deg, var(--blue), #64b5f6);
    }
    
    .btn-bkash {
      box-shadow: 
        0 8px 0 #a50c4d,
        0 15px 20px rgba(0, 0, 0, 0.3);
    }
    
    .btn-bkash::before {
      background: linear-gradient(45deg, var(--bKash), #ff4d94);
    }
    
    .btn-nagod {
      box-shadow: 
        0 8px 0 #c27a0a,
        0 15px 20px rgba(0, 0, 0, 0.3);
    }
    
    .btn-nagod::before {
      background: linear-gradient(45deg, var(--nagod), #ffc257);
    }
    
    .website-section {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 20px;
      margin-top: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
    }
    
    .website-section h3 {
      color: #64b5f6;
      margin-bottom: 15px;
      font-size: 18px;
    }
    
    .footer {
      text-align: center;
      padding: 15px;
      color: #777;
      font-size: 12px;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .firebase-logo {
      display: inline-block;
      margin-top: 10px;
      font-size: 10px;
      background: rgba(255, 152, 0, 0.1);
      padding: 4px 8px;
      border-radius: 4px;
      color: #ffa726;
    }
    
    .ad-container {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }
    
    .ad-label {
      font-size: 12px;
      color: #aaa;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .ad-label img {
      height: 20px;
    }
    
    /* Animation for ad watching */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .pulse {
      animation: pulse 0.5s ease;
    }
    
    .ad-notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 15px 30px;
      border-radius: 10px;
      z-index: 1000;
      display: none;
      font-weight: bold;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    }
    
    /* Navigation Styles */
    .nav-tabs {
      display: flex;
      justify-content: space-around;
      background: rgba(0, 0, 0, 0.2);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .nav-tab {
      padding: 15px 0;
      width: 100%;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
    }
    
    .nav-tab.active {
      border-bottom: 3px solid var(--primary);
      background: rgba(0, 200, 83, 0.1);
    }
    
    .nav-tab:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    
    /* Form Styles */
    .form-container {
      padding: 20px;
      display: none;
    }
    
    .form-container.active {
      display: block;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      color: #aaa;
    }
    
    .form-control {
      width: 100%;
      padding: 12px 15px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      color: white;
      font-size: 16px;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--primary);
    }
    
    .form-footer {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: #aaa;
    }
    
    .form-footer a {
      color: var(--primary);
      text-decoration: none;
      cursor: pointer;
    }
    
    .form-footer a:hover {
      text-decoration: underline;
    }
    
    /* Profile Styles */
    .profile-details {
      margin-bottom: 20px;
    }
    
    .profile-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .profile-item:last-child {
      border-bottom: none;
    }
    
    .profile-label {
      color: #aaa;
    }
    
    .profile-value {
      font-weight: 500;
    }
    
    /* Withdrawal Styles */
    .withdrawal-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin: 20px 0;
    }
    
    .withdrawal-option {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .withdrawal-option:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
    }
    
    .withdrawal-option.active {
      border-color: var(--primary);
      background: rgba(0, 200, 83, 0.1);
    }
    
    .withdrawal-icon {
      font-size: 24px;
      margin-bottom: 10px;
    }
    
    /* bKash and Nagod specific styles */
    .bkash-option.active {
      border-color: var(--bKash);
      background: rgba(226, 19, 110, 0.1);
    }
    
    .nagod-option.active {
      border-color: var(--nagod);
      background: rgba(248, 165, 28, 0.1);
    }
    
    /* Responsive design */
    @media (max-width: 480px) {
      .container {
        border-radius: 15px;
      }
      
      .header {
        padding: 20px 15px;
      }
      
      .header h1 {
        font-size: 24px;
      }
      
      .content {
        padding: 20px;
      }
      
      .btn-3d {
        padding: 14px 16px;
        font-size: 14px;
      }
      
      .withdrawal-options {
        grid-template-columns: 1fr;
      }
    }
    
    /* Loading spinner */
    .spinner {
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top: 3px solid var(--primary);
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
      display: inline-block;
      margin-right: 10px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="ad-notification" id="ad-notification"></div>
  
  <div class="container">
    <div class="header">
      <h1>CTM INCOME üå∏</h1>
      <div class="developer" onclick="window.location.href='https://t.me/ctmtools'">Developer by CTM TOOLS</div>
    </div>
    
    <div class="nav-tabs">
      <div class="nav-tab active" data-tab="dashboard">Dashboard</div>
      <div class="nav-tab" data-tab="profile">Profile</div>
      <div class="nav-tab" data-tab="withdraw">Withdraw</div>
      <div class="nav-tab" data-tab="login" id="auth-tab">Login</div>
    </div>
    
    <!-- Dashboard Tab -->
    <div class="content form-container active" id="dashboard-tab">
      <div class="user-info">
        <div class="user-badge">VIP USER</div>
        <p>Welcome, <span id="user-name">User123</span></p>
        <p>User ID: <span id="user-id">#USR-7694</span></p>
      </div>
      
      <div class="stats">
        <div class="stat-card">
          <h3>Watched Ads</h3>
          <div class="value" id="watched-ads">18</div>
        </div>
        <div class="stat-card">
          <h3>Earned Points</h3>
          <div class="value" id="earned-points">9.00</div>
        </div>
      </div>
      
      <div class="progress-container">
        <div class="progress-label">
          <span>Progress to Bonus</span>
          <span id="ads-progress">30%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
      </div>
      
      <div class="ad-container">
        <div class="ad-label">
          <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0id2hpdGUiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTIwIDRINEMyLjg5IDQgMiA0Ljg5IDIgNnYxMmMwIDEuMTEuODkgMiAyIDJoMTZjMS4xMSAwIDItLjg5IDItMlY2YzAtMS4xMS0uODktMi0yLTJtMCA0bC04IDUtOC01VjZsOCA1IDgtNXoiLz48L3N2Zz4=" alt="Email">
          MONETAG INTERSTITIAL AD
        </div>
        <div class="buttons">
          <button class="btn-3d" id="watch-ad-btn" onclick="watchAd()">
            <span id="btn-text">Watch Ad (+0.50)</span>
          </button>
          <button class="btn-3d btn-secondary" id="auto-ad-btn" onclick="startAutoAds()">Auto Show Ads</button>
          <button class="btn-3d btn-blue" id="stop-auto-btn" onclick="stopAutoAds()" disabled>Stop Auto Ads</button>
        </div>
      </div>
      
      <div class="website-section">
        <h3>Earn More Points</h3>
        <p>Complete more offers to earn additional rewards</p>
        <button class="btn-3d btn-blue" style="margin-top: 15px;" onclick="showOffers()">View Offers</button>
      </div>
    </div>
    
    <!-- Profile Tab -->
    <div class="content form-container" id="profile-tab">
      <h2 style="text-align: center; margin-bottom: 20px;">User Profile</h2>
      
      <div class="profile-details">
        <div class="profile-item">
          <span class="profile-label">Full Name:</span>
          <span class="profile-value" id="profile-name">John Doe</span>
        </div>
        <div class="profile-item">
          <span class="profile-label">Email:</span>
          <span class="profile-value" id="profile-email">johndoe@example.com</span>
        </div>
        <div class="profile-item">
          <span class="profile-label">Phone:</span>
          <span class="profile-value" id="profile-phone">+1 234 567 8900</span>
        </div>
        <div class="profile-item">
          <span class="profile-label">bKash Number:</span>
          <span class="profile-value" id="profile-bkash">Not set</span>
        </div>
        <div class="profile-item">
          <span class="profile-label">Nagad Number:</span>
          <span class="profile-value" id="profile-nagad">Not set</span>
        </div>
        <div class="profile-item">
          <span class="profile-label">Member Since:</span>
          <span class="profile-value" id="profile-join-date">Jan 15, 2023</span>
        </div>
        <div class="profile-item">
          <span class="profile-label">Account Status:</span>
          <span class="profile-value" id="profile-status">Verified</span>
        </div>
      </div>
      
      <div class="buttons">
        <button class="btn-3d" onclick="showEditProfile()">Edit Profile</button>
        <button class="btn-3d btn-secondary" onclick="changePassword()">Change Password</button>
        <button class="btn-3d btn-blue" onclick="logout()">Logout</button>
      </div>
    </div>
    
    <!-- Withdraw Tab -->
    <div class="content form-container" id="withdraw-tab">
      <h2 style="text-align: center; margin-bottom: 20px;">Withdraw Earnings</h2>
      
      <div class="user-info" style="margin-bottom: 25px;">
        <div class="user-badge">Available</div>
        <p style="font-size: 18px; font-weight: bold;">Balance: <span id="withdraw-balance">9.00</span> USD</p>
        <p style="font-size: 12px; color: #aaa;">Minimum withdrawal: $5.00</p>
      </div>
      
      <div class="form-group">
        <label>Select Payment Method</label>
        <div class="withdrawal-options">
          <div class="withdrawal-option bkash-option active" data-method="bkash">
            <div class="withdrawal-icon">üì±</div>
            <div>bKash</div>
          </div>
          <div class="withdrawal-option nagod-option" data-method="nagod">
            <div class="withdrawal-icon">üì±</div>
            <div>Nagad</div>
          </div>
          <div class="withdrawal-option" data-method="paypal">
            <div class="withdrawal-icon">üí≥</div>
            <div>PayPal</div>
          </div>
          <div class="withdrawal-option" data-method="bank">
            <div class="withdrawal-icon">üè¶</div>
            <div>Bank Transfer</div>
          </div>
        </div>
      </div>
      
      <div class="form-group">
        <label for="withdraw-amount">Withdrawal Amount (USD)</label>
        <input type="number" id="withdraw-amount" class="form-control" placeholder="Enter amount" min="5" step="0.01">
      </div>
      
      <div class="form-group" id="account-details-group">
        <label for="account-details" id="account-details-label">bKash Number</label>
        <input type="text" id="account-details" class="form-control" placeholder="Enter your bKash number">
      </div>
      
      <button class="btn-3d btn-bkash" style="width: 100%;" onclick="requestWithdrawal()">Request Withdrawal</button>
      
      <div class="form-footer">
        <p>Processing time: 3-5 business days ‚Ä¢ <a onclick="showWithdrawalHistory()">View withdrawal history</a></p>
      </div>
    </div>
    
    <!-- Login Tab -->
    <div class="content form-container" id="login-tab">
      <h2 style="text-align: center; margin-bottom: 20px;">Login to Your Account</h2>
      
      <div class="form-group">
        <label for="login-email">Email Address</label>
        <input type="email" id="login-email" class="form-control" placeholder="Enter your email">
      </div>
      
      <div class="form-group">
        <label for="login-password">Password</label>
        <input type="password" id="login-password" class="form-control" placeholder="Enter your password">
      </div>
      
      <div class="form-group">
        <button class="btn-3d" style="width: 100%;" onclick="login()">Login</button>
      </div>
      
      <div class="form-footer">
        <p>Don't have an account? <a onclick="showSignup()">Sign up now</a></p>
        <p><a onclick="showForgotPassword()">Forgot your password?</a></p>
      </div>
    </div>
    
    <!-- Signup Tab -->
    <div class="content form-container" id="signup-tab">
      <h2 style="text-align: center; margin-bottom: 20px;">Create an Account</h2>
      
      <div class="form-group">
        <label for="signup-name">Full Name</label>
        <input type="text" id="signup-name" class="form-control" placeholder="Enter your full name">
      </div>
      
      <div class="form-group">
        <label for="signup-email">Email Address</label>
        <input type="email" id="signup-email" class="form-control" placeholder="Enter your email">
      </div>
      
      <div class="form-group">
        <label for="signup-password">Password</label>
        <input type="password" id="signup-password" class="form-control" placeholder="Create a password">
      </div>
      
      <div class="form-group">
        <label for="signup-confirm">Confirm Password</label>
        <input type="password" id="signup-confirm" class="form-control" placeholder="Confirm your password">
      </div>
      
      <div class="form-group">
        <button class="btn-3d" style="width: 100%;" onclick="signup()">Create Account</button>
      </div>
      
      <div class="form-footer">
        <p>Already have an account? <a onclick="showLogin()">Login here</a></p>
      </div>
    </div>
    
    <!-- Forgot Password Tab -->
    <div class="content form-container" id="forgot-tab">
      <h2 style="text-align: center; margin-bottom: 20px;">Reset Your Password</h2>
      
      <div class="form-group">
        <label for="forgot-email">Email Address</label>
        <input type="email" id="forgot-email" class="form-control" placeholder="Enter your email">
      </div>
      
      <div class="form-group">
        <button class="btn-3d" style="width: 100%;" onclick="resetPassword()">Send Reset Link</button>
      </div>
      
      <div class="form-footer">
        <p>Remember your password? <a onclick="showLogin()">Login here</a></p>
      </div>
    </div>
    
    <!-- Edit Profile Tab -->
    <div class="content form-container" id="edit-profile-tab">
      <h2 style="text-align: center; margin-bottom: 20px;">Edit Profile</h2>
      
      <div class="form-group">
        <label for="edit-name">Full Name</label>
        <input type="text" id="edit-name" class="form-control" placeholder="Enter your full name">
      </div>
      
      <div class="form-group">
        <label for="edit-phone">Phone Number</label>
        <input type="tel" id="edit-phone" class="form-control" placeholder="Enter your phone number">
      </div>
      
      <div class="form-group">
        <label for="edit-bkash">bKash Number</label>
        <input type="text" id="edit-bkash" class="form-control" placeholder="Enter your bKash number">
      </div>
      
      <div class="form-group">
        <label for="edit-nagad">Nagad Number</label>
        <input type="text" id="edit-nagad" class="form-control" placeholder="Enter your Nagad number">
      </div>
      
      <div class="buttons">
        <button class="btn-3d" style="width: 100%;" onclick="saveProfile()">Save Changes</button>
        <button class="btn-3d btn-secondary" style="width: 100%;" onclick="showProfile()">Cancel</button>
      </div>
    </div>
    
    <div class="footer">
      <p>Secured by Firebase ‚Ä¢ All transactions are protected</p>
      <div class="firebase-logo">Firebase</div>
    </div>
  </div>

  <script>
    // Firebase configuration - Replace with your actual Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBr0Jd0HRH-vkI-WKG1NmnJ5roOs7rmzOU",
      authDomain: "free-c0366.firebaseapp.com",
      projectId: "free-c0366",
      storageBucket: "free-c0366.appspot.com",
      messagingSenderId: "33574350495",
      appId: "1:33574350495:android:4e755248c1ba6d1a7f3caa"
    };
    
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    
    // Constants
    const POINTS_PER_AD = 0.50;
    const ADS_FOR_BONUS = 10;
    const BONUS_POINTS = 1.00;
    
    // State variables
    let watchedAdsCount = 0;
    let earnedPoints = 0;
    let autoAdInterval = null;
    let isAdLoading = false;
    let userId = null;
    let isLoggedIn = false;
    let currentUser = null;
    let userData = null;
    
    // DOM Elements
    const watchedAdsEl = document.getElementById('watched-ads');
    const earnedPointsEl = document.getElementById('earned-points');
    const adsProgressEl = document.getElementById('ads-progress');
    const progressFillEl = document.getElementById('progress-fill');
    const adNotificationEl = document.getElementById('ad-notification');
    const authTabEl = document.getElementById('auth-tab');
    const withdrawBalanceEl = document.getElementById('withdraw-balance');
    
    // Initialize the app
    function initApp() {
      // Set up auth state listener
      auth.onAuthStateChanged((user) => {
        if (user) {
          // User is signed in
          currentUser = user;
          isLoggedIn = true;
          authTabEl.textContent = "Logout";
          
          // Load user data from Firestore
          loadUserData(user.uid);
        } else {
          // User is signed out
          currentUser = null;
          isLoggedIn = false;
          authTabEl.textContent = "Login";
          showLogin();
        }
      });
      
      // Set up withdrawal method change listener
      setupWithdrawalOptions();
      
      updateUI();
      setupNavigation();
    }
    
    // Load user data from Firestore
    function loadUserData(uid) {
      db.collection("users").doc(uid).get()
        .then((doc) => {
          if (doc.exists) {
            userData = doc.data();
            watchedAdsCount = userData.watchedAds || 0;
            earnedPoints = userData.earnedPoints || 0;
            
            // Update UI with user data
            document.getElementById('user-name').textContent = userData.name || currentUser.email;
            document.getElementById('user-id').textContent = `#${uid.substring(0, 8)}`;
            
            // Update profile tab
            document.getElementById('profile-name').textContent = userData.name || currentUser.displayName || currentUser.email;
            document.getElementById('profile-email').textContent = currentUser.email;
            document.getElementById('profile-phone').textContent = userData.phone || 'Not provided';
            document.getElementById('profile-bkash').textContent = userData.bkash || 'Not set';
            document.getElementById('profile-nagad').textContent = userData.nagad || 'Not set';
            document.getElementById('profile-join-date').textContent = new Date(userData.joinDate || currentUser.metadata.creationTime).toLocaleDateString();
            document.getElementById('profile-status').textContent = userData.status || 'Basic';
            
            updateUI();
          } else {
            // Create new user document if it doesn't exist
            createUserDocument(uid);
          }
        })
        .catch((error) => {
          console.error("Error getting user document:", error);
          showAdNotification("Error loading user data");
        });
    }
    
    // Create a new user document in Firestore
    function createUserDocument(uid) {
      const userData = {
        name: currentUser.displayName || currentUser.email,
        email: currentUser.email,
        watchedAds: 0,
        earnedPoints: 0,
        joinDate: new Date().toISOString(),
        status: 'Basic',
        withdrawals: []
      };
      
      db.collection("users").doc(uid).set(userData)
        .then(() => {
          console.log("User document created successfully");
          loadUserData(uid);
        })
        .catch((error) => {
          console.error("Error creating user document:", error);
        });
    }
    
    // Setup navigation tabs
    function setupNavigation() {
      const tabs = document.querySelectorAll('.nav-tab');
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const tabName = tab.getAttribute('data-tab');
          
          // If not logged in, only show login/signup
          if (!isLoggedIn && (tabName === 'dashboard' || tabName === 'profile' || tabName === 'withdraw')) {
            showLogin();
            return;
          }
          
          // Update active tab
          tabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          
          // Show corresponding content
          document.querySelectorAll('.form-container').forEach(container => {
            container.classList.remove('active');
          });
          document.getElementById(`${tabName}-tab`).classList.add('active');
        });
      });
    }
    
    // Setup withdrawal options
    function setupWithdrawalOptions() {
      const options = document.querySelectorAll('.withdrawal-option');
      const accountDetailsLabel = document.getElementById('account-details-label');
      const accountDetailsInput = document.getElementById('account-details');
      const withdrawButton = document.querySelector('#withdraw-tab .btn-3d');
      
      options.forEach(option => {
        option.addEventListener('click', () => {
          options.forEach(o => o.classList.remove('active'));
          option.classList.add('active');
          
          const method = option.getAttribute('data-method');
          
          // Update form based on selected method
          if (method === 'bkash') {
            accountDetailsLabel.textContent = 'bKash Number';
            accountDetailsInput.placeholder = 'Enter your bKash number';
            withdrawButton.className = 'btn-3d btn-bkash';
            withdrawButton.style.width = '100%';
          } else if (method === 'nagod') {
            accountDetailsLabel.textContent = 'Nagad Number';
            accountDetailsInput.placeholder = 'Enter your Nagad number';
            withdrawButton.className = 'btn-3d btn-nagod';
            withdrawButton.style.width = '100%';
          } else if (method === 'paypal') {
            accountDetailsLabel.textContent = 'PayPal Email';
            accountDetailsInput.placeholder = 'Enter your PayPal email';
            withdrawButton.className = 'btn-3d btn-blue';
            withdrawButton.style.width = '100%';
          } else {
            accountDetailsLabel.textContent = 'Account Details';
            accountDetailsInput.placeholder = 'Enter your account details';
            withdrawButton.className = 'btn-3d';
            withdrawButton.style.width = '100%';
          }
        });
      });
    }
    
    // Update UI elements
    function updateUI() {
      watchedAdsEl.textContent = watchedAdsCount;
      earnedPointsEl.textContent = earnedPoints.toFixed(2);
      withdrawBalanceEl.textContent = earnedPoints.toFixed(2);
      
      const progress = (watchedAdsCount % ADS_FOR_BONUS) / ADS_FOR_BONUS * 100;
      adsProgressEl.textContent = `${Math.round(progress)}%`;
      progressFillEl.style.width = `${progress}%`;
      
      // Add animation when points change
      earnedPointsEl.classList.remove('pulse');
      void earnedPointsEl.offsetWidth; // Trigger reflow
      earnedPointsEl.classList.add('pulse');
      
      // Update button states
      const stopAutoBtn = document.getElementById('stop-auto-btn');
      if (stopAutoBtn) {
        stopAutoBtn.disabled = autoAdInterval === null;
      }
    }
    
    // Show login form
    function showLogin() {
      document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.form-container').forEach(container => container.classList.remove('active'));
      
      document.getElementById('login-tab').classList.add('active');
      document.querySelector('[data-tab="login"]').classList.add('active');
    }
    
    // Show signup form
    function showSignup() {
      document.querySelectorAll('.form-container').forEach(container => container.classList.remove('active'));
      document.getElementById('signup-tab').classList.add('active');
    }
    
    // Show profile form
    function showProfile() {
      document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.form-container').forEach(container => container.classList.remove('active'));
      
      document.getElementById('profile-tab').classList.add('active');
      document.querySelector('[data-tab="profile"]').classList.add('active');
    }
    
    // Show edit profile form
    function showEditProfile() {
      document.querySelectorAll('.form-container').forEach(container => container.classList.remove('active'));
      document.getElementById('edit-profile-tab').classList.add('active');
      
      // Pre-fill form with current data
      document.getElementById('edit-name').value = userData.name || '';
      document.getElementById('edit-phone').value = userData.phone || '';
      document.getElementById('edit-bkash').value = userData.bkash || '';
      document.getElementById('edit-nagad').value = userData.nagad || '';
    }
    
    // Save profile changes
    function saveProfile() {
      const name = document.getElementById('edit-name').value;
      const phone = document.getElementById('edit-phone').value;
      const bkash = document.getElementById('edit-bkash').value;
      const nagad = document.getElementById('edit-nagad').value;
      
      // Update user data in Firestore
      db.collection("users").doc(currentUser.uid).update({
        name: name,
        phone: phone,
        bkash: bkash,
        nagad: nagad
      })
      .then(() => {
        showAdNotification("Profile updated successfully");
        loadUserData(currentUser.uid); // Reload user data
        showProfile(); // Return to profile view
      })
      .catch((error) => {
        console.error("Error updating profile:", error);
        showAdNotification("Error updating profile");
      });
    }
    
    // Show forgot password form
    function showForgotPassword() {
      document.querySelectorAll('.form-container').forEach(container => container.classList.remove('active'));
      document.getElementById('forgot-tab').classList.add('active');
    }
    
    // Login function
    function login() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      if (!email || !password) {
        showAdNotification('Please enter both email and password');
        return;
      }
      
      // Show loading state
      const loginBtn = document.querySelector('#login-tab .btn-3d');
      const originalText = loginBtn.innerHTML;
      loginBtn.innerHTML = '<div class="spinner"></div> Logging in...';
      loginBtn.disabled = true;
      
      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Signed in 
          showAdNotification('Login successful!');
          
          // Show dashboard
          document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
          document.querySelectorAll('.form-container').forEach(container => container.classList.remove('active'));
          
          document.getElementById('dashboard-tab').classlection.add('active');
          document.querySelector('[data-tab="dashboard"]').classList.add('active');
        })
        .catch((error) => {
          console.error("Login error:", error);
          showAdNotification('Login failed: ' + error.message);
          
          // Restore button
          loginBtn.innerHTML = originalText;
          loginBtn.disabled = false;
        });
    }
    
    // Signup function
    function signup() {
      const name = document.getElementById('signup-name').value;
      const email = document.getElementById('signup-email').value;
      const password = document.getElementById('signup-password').value;
      const confirm = document.getElementById('signup-confirm').value;
      
      if (!name || !email || !password || !confirm) {
        showAdNotification('Please fill all fields');
        return;
      }
      
      if (password !== confirm) {
        showAdNotification('Passwords do not match');
        return;
      }
      
      // Show loading state
      const signupBtn = document.querySelector('#signup-tab .btn-3d');
      const originalText = signupBtn.innerHTML;
      signupBtn.innerHTML = '<div class="spinner"></div> Creating account...';
      signupBtn.disabled = true;
      
      auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Signed up successfully
          const user = userCredential.user;
          
          // Create user document in Firestore
          return db.collection("users").doc(user.uid).set({
            name: name,
            email: email,
            watchedAds: 0,
            earnedPoints: 0,
            joinDate: new Date().toISOString(),
            status: 'Basic',
            withdrawals: []
          });
        })
        .then(() => {
          showAdNotification('Account created successfully!');
          showLogin();
        })
        .catch((error) => {
          console.error("Signup error:", error);
          showAdNotification('Signup failed: ' + error.message);
          
          // Restore button
          signupBtn.innerHTML = originalText;
          signupBtn.disabled = false;
        });
    }
    
    // Reset password function
    function resetPassword() {
      const email = document.getElementById('forgot-email').value;
      
      if (!email) {
        showAdNotification('Please enter your email');
        return;
      }
      
      // Show loading state
      const resetBtn = document.querySelector('#forgot-tab .btn-3d');
      const originalText = resetBtn.innerHTML;
      resetBtn.innerHTML = '<div class="spinner"></div> Sending...';
      resetBtn.disabled = true;
      
      auth.sendPasswordResetEmail(email)
        .then(() => {
          showAdNotification('Password reset email sent. Check your inbox.');
          showLogin();
        })
        .catch((error) => {
          console.error("Password reset error:", error);
          showAdNotification('Error: ' + error.message);
          
          // Restore button
          resetBtn.innerHTML = originalText;
          resetBtn.disabled = false;
        });
    }
    
    // Logout function
    function logout() {
      auth.signOut()
        .then(() => {
          showAdNotification('Logged out successfully');
        })
        .catch((error) => {
          console.error("Logout error:", error);
        });
    }
    
    // Change password
    function changePassword() {
      const newPassword = prompt("Enter your new password:");
      if (!newPassword) return;
      
      if (newPassword.length < 6) {
        showAdNotification('Password must be at least 6 characters');
        return;
      }
      
      currentUser.updatePassword(newPassword)
        .then(() => {
          showAdNotification('Password updated successfully');
        })
        .catch((error) => {
          console.error("Password change error:", error);
          showAdNotification('Error changing password: ' + error.message);
        });
    }
    
    // Request withdrawal
    function requestWithdrawal() {
      if (!isLoggedIn) {
        showAdNotification('Please login to request withdrawal');
        showLogin();
        return;
      }
      
      const amount = parseFloat(document.getElementById('withdraw-amount').value);
      const accountDetails = document.getElementById('account-details').value;
      const method = document.querySelector('.withdrawal-option.active').getAttribute('data-method');
      
      if (!amount || amount < 5) {
        showAdNotification('Minimum withdrawal amount is $5');
        return;
      }
      
      if (amount > earnedPoints) {
        showAdNotification('Insufficient balance');
        return;
      }
      
      if (!accountDetails) {
        showAdNotification('Please enter your account details');
        return;
      }
      
      // Validate bKash/Nagad numbers (Bangladesh mobile numbers)
      if ((method === 'bkash' || method === 'nagod') && !isValidBangladeshiNumber(accountDetails)) {
        showAdNotification('Please enter a valid Bangladeshi mobile number (11 digits starting with 01)');
        return;
      }
      
      // Show loading state
      const withdrawBtn = document.querySelector('#withdraw-tab .btn-3d');
      const originalText = withdrawBtn.innerHTML;
      withdrawBtn.innerHTML = '<div class="spinner"></div> Processing...';
      withdrawBtn.disabled = true;
      
      // Create withdrawal request
      const withdrawalData = {
        amount: amount,
        method: method,
        accountDetails: accountDetails,
        status: 'pending',
        requestDate: new Date().toISOString(),
        processedDate: null
      };
      
      // Update user data in Firestore
      db.collection("users").doc(currentUser.uid).update({
        earnedPoints: firebase.firestore.FieldValue.increment(-amount),
        withdrawals: firebase.firestore.FieldValue.arrayUnion(withdrawalData)
      })
      .then(() => {
        // Update local state
        earnedPoints -= amount;
        
        showAdNotification(`Withdrawal request of $${amount.toFixed(2)} to ${method} submitted`);
        updateUI();
        
        // Clear form
        document.getElementById('withdraw-amount').value = '';
        document.getElementById('account-details').value = '';
        
        // Reload user data to get updated withdrawals array
        loadUserData(currentUser.uid);
      })
      .catch((error) => {
        console.error("Withdrawal error:", error);
        showAdNotification("Error processing withdrawal: " + error.message);
      })
      .finally(() => {
        // Restore button
        withdrawBtn.innerHTML = originalText;
        withdrawBtn.disabled = false;
      });
    }
    
    // Validate Bangladeshi mobile numbers
    function isValidBangladeshiNumber(number) {
      const regex = /^01[3-9]\d{8}$/;
      return regex.test(number);
    }
    
    // Show withdrawal history
    function showWithdrawalHistory() {
      if (!userData || !userData.withdrawals) {
        showAdNotification('No withdrawal history found');
        return;
      }
      
      let historyMessage = 'Withdrawal History:\n\n';
      userData.withdrawals.forEach((withdrawal, index) => {
        historyMessage += `${index + 1}. $${withdrawal.amount} via ${withdrawal.method} (${withdrawal.status})\n`;
      });
      
      alert(historyMessage);
    }
    
    // Watch ad function using Monetag
    function watchAd() {
      if (isAdLoading) return;
      
      if (!isLoggedIn) {
        showAdNotification('Please login to watch ads');
        showLogin();
        return;
      }
      
      isAdLoading = true;
      const btnText = document.getElementById('btn-text');
      btnText.textContent = "Loading Ad...";
      
      // Show ad notification
      showAdNotification("Loading ad... Please wait");
      
      // Show Monetag ad - Rewarded interstitial
      if (typeof show_9903237 === 'function') {
        show_9903237().then(() => {
          // User watched the ad successfully
          completeAdView();
        }).catch(error => {
          console.error("Ad error:", error);
          showAdNotification("Failed to show ad. Please try again.");
          resetAdButton();
        });
      } else {
        // Fallback to simulated ad if Monetag is not available
        showAdNotification("Monetag not available. Using simulated ad.");
        setTimeout(() => {
          completeAdView();
        }, 2000);
      }
    }
    
    // Complete ad view and reward user
    function completeAdView() {
      const pointsToAdd = POINTS_PER_AD;
      let bonusMessage = "";
      
      // Every 10 ads, give bonus points
      if ((watchedAdsCount + 1) % ADS_FOR_BONUS === 0) {
        bonusMessage = `Bonus! +${BONUS_POINTS.toFixed(2)} points for completing ${ADS_FOR_BONUS} ads!`;
      }
      
      // Update user data in Firestore
      db.collection("users").doc(currentUser.uid).update({
        watchedAds: firebase.firestore.FieldValue.increment(1),
        earnedPoints: firebase.firestore.FieldValue.increment(
          (watchedAdsCount + 1) % ADS_FOR_BONUS === 0 ? 
          pointsToAdd + BONUS_POINTS : pointsToAdd
        )
      })
      .then(() => {
        // Update local state
        watchedAdsCount++;
        earnedPoints += pointsToAdd;
        
        if ((watchedAdsCount) % ADS_FOR_BONUS === 0) {
          earnedPoints += BONUS_POINTS;
          showAdNotification(`Ad completed! +${pointsToAdd.toFixed(2)} points. ${bonusMessage}`);
        } else {
          showAdNotification("Ad completed! +0.50 points added to your account");
        }
        
        updateUI();
        resetAdButton();
      })
      .catch((error) => {
        console.error("Error updating ad view:", error);
        showAdNotification("Error updating your points");
        resetAdButton();
      });
    }
    
    // Reset ad button state
    function resetAdButton() {
      isAdLoading = false;
      const btnText = document.getElementById('btn-text');
      btnText.textContent = "Watch Ad (+0.50)";
    }
    
    // Auto show ads
    function startAutoAds() {
      if (autoAdInterval) return;
      
      if (!isLoggedIn) {
        showAdNotification('Please login to use auto ads');
        showLogin();
        return;
      }
      
      autoAdInterval = setInterval(() => {
        if (!isAdLoading) {
          watchAd();
        }
      }, 30000); // Auto show ad every 30 seconds
      
      document.getElementById('auto-ad-btn').textContent = "Auto Ads Running...";
      document.getElementById('auto-ad-btn').disabled = true;
      document.getElementById('stop-auto-btn').disabled = false;
      
      showAdNotification("Auto ads started. Ads will play every 30 seconds.");
      updateUI();
    }
    
    // Stop auto ads
    function stopAutoAds() {
      if (!autoAdInterval) return;
      
      clearInterval(autoAdInterval);
      autoAdInterval = null;
      
      document.getElementById('auto-ad-btn').textContent = "Auto Show Ads";
      document.getElementById('auto-ad-btn').disabled = false;
      document.getElementById('stop-auto-btn').disabled = true;
      
      showAdNotification("Auto ads stopped.");
      updateUI();
    }
    
    // Show offers (placeholder function)
    function showOffers() {
      showAdNotification("Offers feature coming soon!");
    }
    
    // Show ad notification
    function showAdNotification(message) {
      adNotificationEl.textContent = message;
      adNotificationEl.style.display = 'block';
      
      setTimeout(() => {
        adNotificationEl.style.display = 'none';
      }, 3000);
    }
    
    // Initialize app on load
    window.onload = initApp;
  </script>
</body>
</html>